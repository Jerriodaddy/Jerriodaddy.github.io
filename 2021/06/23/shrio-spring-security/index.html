<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/silver/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.9.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>
<meta name="description" content="Security is a primary concern in the world of application development, especially in the area of enterprise web and mobile applications. In this quick tutorial, we’ll compare two popular Java Security">
<meta property="og:type" content="article">
<meta property="og:title" content="Shrio VS Spring Security [转]">
<meta property="og:url" content="http://example.com/2021/06/23/shrio-spring-security/index.html">
<meta property="og:site_name" content="Jerrio&#39;s Blog">
<meta property="og:description" content="Security is a primary concern in the world of application development, especially in the area of enterprise web and mobile applications. In this quick tutorial, we’ll compare two popular Java Security">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-06-23T09:20:57.000Z">
<meta property="article:modified_time" content="2021-06-23T10:13:31.602Z">
<meta property="article:author" content="Jerrio">
<meta property="article:tag" content="Security">
<meta property="article:tag" content="SpringBoot">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2021/06/23/shrio-spring-security/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2021/06/23/shrio-spring-security/","path":"2021/06/23/shrio-spring-security/","title":"Shrio VS Spring Security [转]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Shrio VS Spring Security [转] | Jerrio's Blog</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jerrio's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">7</span></a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">6</span></a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">10</span></a></li>
        <li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a></li>
        <li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Overview"><span class="nav-number">1.</span> <span class="nav-text">1. Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-A-Little-Background"><span class="nav-number">2.</span> <span class="nav-text">2. A Little Background</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Configuring-Apache-Shiro"><span class="nav-number">3.</span> <span class="nav-text">3. Configuring Apache Shiro</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-Maven-Dependencies"><span class="nav-number">3.1.</span> <span class="nav-text">3.1. Maven Dependencies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-Creating-a-Realm"><span class="nav-number">3.2.</span> <span class="nav-text">3.2. Creating a Realm</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Configuring-Spring-Security"><span class="nav-number">4.</span> <span class="nav-text">4. Configuring Spring Security</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-Maven-Dependencies"><span class="nav-number">4.1.</span> <span class="nav-text">4.1. Maven Dependencies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-Configuration-Class"><span class="nav-number">4.2.</span> <span class="nav-text">4.2. Configuration Class</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Controllers-and-Endpoints"><span class="nav-number">5.</span> <span class="nav-text">5. Controllers and Endpoints</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-Endpoints-for-View-Rendering"><span class="nav-number">5.1.</span> <span class="nav-text">5.1. Endpoints for View Rendering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-POST-Login-Endpoint"><span class="nav-number">5.2.</span> <span class="nav-text">5.2. POST Login Endpoint</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-Admin-Only-Endpoint"><span class="nav-number">5.3.</span> <span class="nav-text">5.3. Admin-Only Endpoint</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-4-Logout-Endpoint"><span class="nav-number">5.4.</span> <span class="nav-text">5.4. Logout Endpoint</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Apache-Shiro-vs-Spring-Security"><span class="nav-number">6.</span> <span class="nav-text">6. Apache Shiro vs Spring Security</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Conclusion"><span class="nav-number">7.</span> <span class="nav-text">7. Conclusion</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jerrio"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Jerrio</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Jerriodaddy" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Jerriodaddy" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jerrio20@outlook.com" title="E-Mail → mailto:jerrio20@outlook.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/Jerriodaddy" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/06/23/shrio-spring-security/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Jerrio">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jerrio's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shrio VS Spring Security [转]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>
      

      <time title="Created: 2021-06-23 17:20:57 / Modified: 18:13:31" itemprop="dateCreated datePublished" datetime="2021-06-23T17:20:57+08:00">2021-06-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/System-Architecture/" itemprop="url" rel="index"><span itemprop="name">System Architecture</span></a>
        </span>
    </span>

  
    <span id="/2021/06/23/shrio-spring-security/" class="post-meta-item leancloud_visitors" data-flag-title="Shrio VS Spring Security [转]" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Security is a primary concern in the world of application development, especially in the area of enterprise web and mobile applications.</p>
<p>In this quick tutorial, <strong>we’ll compare two popular Java Security frameworks – <a target="_blank" rel="noopener" href="https://shiro.apache.org/">Apache Shiro</a> and <a target="_blank" rel="noopener" href="https://spring.io/projects/spring-security">Spring Security</a>.</strong></p>
<span id="more"></span>

<h2 id="1-Overview"><a href="#1-Overview" class="headerlink" title="1. Overview"></a>1. Overview</h2><p>Security is a primary concern in the world of application development, especially in the area of enterprise web and mobile applications.</p>
<p>In this quick tutorial, <strong>we’ll compare two popular Java Security frameworks – <a target="_blank" rel="noopener" href="https://shiro.apache.org/">Apache Shiro</a> and <a target="_blank" rel="noopener" href="https://spring.io/projects/spring-security">Spring Security</a>.</strong></p>
<h2 id="2-A-Little-Background"><a href="#2-A-Little-Background" class="headerlink" title="2. A Little Background"></a>2. A Little Background</h2><p>Apache Shiro was born in 2004 as JSecurity and was accepted by the Apache Foundation in 2008. To date, it has seen many releases, the latest as of writing this is 1.5.3.</p>
<p>Spring Security started as Acegi in 2003 and was incorporated into the Spring Framework with its first public release in 2008. Since its inception, it has gone through several iterations and the current GA version as of writing this is 5.3.2.</p>
<p>Both technologies offer <strong>authentication and authorization support along with cryptography and session management solutions</strong>. Additionally, Spring Security provides first-class protection against attacks such as CSRF and session fixation.</p>
<p>In the next few sections, we’ll see examples of how the two technologies handle authentication and authorization. To keep things simple, we’ll be using basic Spring Boot based MVC applications with FreeMarker templates.</p>
<h2 id="3-Configuring-Apache-Shiro"><a href="#3-Configuring-Apache-Shiro" class="headerlink" title="3. Configuring Apache Shiro"></a>3. Configuring Apache Shiro</h2><p>To start with, let’s see how configurations differ between the two frameworks.</p>
<h3 id="3-1-Maven-Dependencies"><a href="#3-1-Maven-Dependencies" class="headerlink" title="3.1. Maven Dependencies"></a>3.1. Maven Dependencies</h3><p>Since we’ll use Shiro in a Spring Boot App, we’ll need its starter and the shiro-core module:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-spring-boot-web-starter&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.shiro&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;shiro-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.3&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>The latest versions can be found on Maven Central.</p>
<h3 id="3-2-Creating-a-Realm"><a href="#3-2-Creating-a-Realm" class="headerlink" title="3.2. Creating a Realm"></a>3.2. Creating a Realm</h3><p>To declare users with their roles and permissions in-memory, we need to create a realm extending Shiro’s JdbcRealm. We’ll define two users – Tom and Jerry, with roles USER and ADMIN, respectively:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomRealm</span> <span class="keyword">extends</span> <span class="title">JdbcRealm</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; credentials = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Set&gt; roles = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Set&gt; permissions = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        credentials.put(<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;password&quot;</span>);</span><br><span class="line">        credentials.put(<span class="string">&quot;Jerry&quot;</span>, <span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        roles.put(<span class="string">&quot;Jerry&quot;</span>, <span class="keyword">new</span> HashSet&lt;&gt;(Arrays.asList(<span class="string">&quot;ADMIN&quot;</span>)));</span><br><span class="line">        roles.put(<span class="string">&quot;Tom&quot;</span>, <span class="keyword">new</span> HashSet&lt;&gt;(Arrays.asList(<span class="string">&quot;USER&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        permissions.put(<span class="string">&quot;ADMIN&quot;</span>, <span class="keyword">new</span> HashSet&lt;&gt;(Arrays.asList(<span class="string">&quot;READ&quot;</span>, <span class="string">&quot;WRITE&quot;</span>)));</span><br><span class="line">        permissions.put(<span class="string">&quot;USER&quot;</span>, <span class="keyword">new</span> HashSet&lt;&gt;(Arrays.asList(<span class="string">&quot;READ&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, to enable retrieval of this authentication and authorization, we need to override a few methods:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken token)</span> </span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">    UsernamePasswordToken userToken = (UsernamePasswordToken) token;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (userToken.getUsername() == <span class="keyword">null</span> || userToken.getUsername().isEmpty() ||</span><br><span class="line">      !credentials.containsKey(userToken.getUsername())) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnknownAccountException(<span class="string">&quot;User doesn&#x27;t exist&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(userToken.getUsername(), </span><br><span class="line">      credentials.get(userToken.getUsername()), getName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principals)</span> </span>&#123;</span><br><span class="line">    Set roles = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    Set permissions = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Object user : principals) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            roles.addAll(getRoleNamesForUser(<span class="keyword">null</span>, (String) user));</span><br><span class="line">            permissions.addAll(getPermissions(<span class="keyword">null</span>, <span class="keyword">null</span>, roles));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            logger.error(e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    SimpleAuthorizationInfo authInfo = <span class="keyword">new</span> SimpleAuthorizationInfo(roles);</span><br><span class="line">    authInfo.setStringPermissions(permissions);</span><br><span class="line">    <span class="keyword">return</span> authInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The method <em>doGetAuthorizationInfo</em> is using a couple of helper methods to get the user’s roles and permissions:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Set <span class="title">getRoleNamesForUser</span><span class="params">(Connection conn, String username)</span> </span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!roles.containsKey(username)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> SQLException(<span class="string">&quot;User doesn&#x27;t exist&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> roles.get(username);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Set <span class="title">getPermissions</span><span class="params">(Connection conn, String username, Collection roles)</span> </span></span><br><span class="line"><span class="function">  <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">    Set userPermissions = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (String role : roles) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!permissions.containsKey(role)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> SQLException(<span class="string">&quot;Role doesn&#x27;t exist&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        userPermissions.addAll(permissions.get(role));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> userPermissions;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Next, we need to include this <em>CustomRealm</em> as a bean in our Boot Application:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Realm <span class="title">customRealm</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CustomRealm();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Additionally, to configure authentication for our endpoints, we need another bean:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ShiroFilterChainDefinition <span class="title">shiroFilterChainDefinition</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    DefaultShiroFilterChainDefinition filter = <span class="keyword">new</span> DefaultShiroFilterChainDefinition();</span><br><span class="line"></span><br><span class="line">    filter.addPathDefinition(<span class="string">&quot;/home&quot;</span>, <span class="string">&quot;authc&quot;</span>);</span><br><span class="line">    filter.addPathDefinition(<span class="string">&quot;/**&quot;</span>, <span class="string">&quot;anon&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> filter;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here, using a <em>DefaultShiroFilterChainDefinition</em> instance, we specified that our <em>/home</em> endpoint can only be accessed by authenticated users.</p>
<p>That’s all we need for the configuration, Shiro does the rest for us.</p>
<h2 id="4-Configuring-Spring-Security"><a href="#4-Configuring-Spring-Security" class="headerlink" title="4. Configuring Spring Security"></a>4. Configuring Spring Security</h2><p>Now let’s see how to achieve the same in Spring.</p>
<h3 id="4-1-Maven-Dependencies"><a href="#4-1-Maven-Dependencies" class="headerlink" title="4.1. Maven Dependencies"></a>4.1. Maven Dependencies</h3><p>First, the dependencies:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>The latest versions can be found on <a target="_blank" rel="noopener" href="https://search.maven.org/classic/#search%7Cga%7C1%7Cg%3A%22org.springframework.boot%22%20AND%20a%3A%22spring-boot-starter%22">Maven Central</a>.</p>
<h3 id="4-2-Configuration-Class"><a href="#4-2-Configuration-Class" class="headerlink" title="4.2. Configuration Class"></a>4.2. Configuration Class</h3><p>Next, we’ll define our Spring Security configuration in a class <em>SecurityConfig</em>, extending <em>WebSecurityConfigurerAdapter</em>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableWebSecurity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SecurityConfig</span> <span class="keyword">extends</span> <span class="title">WebSecurityConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        http</span><br><span class="line">          .authorizeRequests(authorize -&gt; authorize</span><br><span class="line">            .antMatchers(<span class="string">&quot;/index&quot;</span>, <span class="string">&quot;/login&quot;</span>).permitAll()</span><br><span class="line">            .antMatchers(<span class="string">&quot;/home&quot;</span>, <span class="string">&quot;/logout&quot;</span>).authenticated()</span><br><span class="line">            .antMatchers(<span class="string">&quot;/admin/**&quot;</span>).hasRole(<span class="string">&quot;ADMIN&quot;</span>))</span><br><span class="line">          .formLogin(formLogin -&gt; formLogin</span><br><span class="line">            .loginPage(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">            .failureUrl(<span class="string">&quot;/login-error&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        auth.inMemoryAuthentication()</span><br><span class="line">          .withUser(<span class="string">&quot;Jerry&quot;</span>)</span><br><span class="line">            .password(passwordEncoder().encode(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">            .authorities(<span class="string">&quot;READ&quot;</span>, <span class="string">&quot;WRITE&quot;</span>)</span><br><span class="line">            .roles(<span class="string">&quot;ADMIN&quot;</span>)</span><br><span class="line">            .and()</span><br><span class="line">          .withUser(<span class="string">&quot;Tom&quot;</span>)</span><br><span class="line">            .password(passwordEncoder().encode(<span class="string">&quot;password&quot;</span>))</span><br><span class="line">            .authorities(<span class="string">&quot;READ&quot;</span>)</span><br><span class="line">            .roles(<span class="string">&quot;USER&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PasswordEncoder <span class="title">passwordEncoder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> BCryptPasswordEncoder();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>As we can see, we built an <em>AuthenticationManagerBuilder</em> object to declare our users with their roles and authorities. Additionally, we encoded the passwords using a <em>BCryptPasswordEncoder</em>.</p>
<p>Spring Security also provides us with its <em>HttpSecurity</em> object for further configurations. For our example, we’ve allowed:</p>
<ul>
<li>everyone to access our <em>index</em> and <em>login</em> pages</li>
<li>only authenticated users to enter the <em>home</em> page and <em>logout</em></li>
<li>only users with ADMIN role to access the <em>admin</em> pages</li>
</ul>
<p>We’ve also defined support for form-based authentication to send users to the <em>login</em> endpoint. In case login fails, our users will be redirected to <em>/login-error.</em></p>
<h2 id="5-Controllers-and-Endpoints"><a href="#5-Controllers-and-Endpoints" class="headerlink" title="5. Controllers and Endpoints"></a>5. Controllers and Endpoints</h2><p>Now let’s have a look at our web controller mappings for the two applications. While they’ll use the same endpoints, some implementations will differ.</p>
<h3 id="5-1-Endpoints-for-View-Rendering"><a href="#5-1-Endpoints-for-View-Rendering" class="headerlink" title="5.1. Endpoints for View Rendering"></a>5.1. Endpoints for View Rendering</h3><p>For endpoints rendering the view, the implementations are the same:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">showLoginPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;login&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/home&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getMeHome</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    addUserAttributes(model);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Both our controller implementations, Shiro as well as Spring Security, return the <em>index.ftl</em> on the root endpoint, <em>login.ftl</em> on the login endpoint, and <em>home.ftl</em> on the home endpoint.</p>
<p>However, the definition of the method <em>addUserAttributes</em> at the <em>/home</em> endpoint will differ between the two controllers. This method introspects the currently logged in user’s attributes.</p>
<p>Shiro provides a <em>SecurityUtils.getSubject</em> to retrieve the current <em>Subject</em>, and its roles and permissions:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUserAttributes</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    Subject currentUser = SecurityUtils.getSubject();</span><br><span class="line">    String permission = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;ADMIN&quot;</span>)) &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;role&quot;</span>, <span class="string">&quot;ADMIN&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;USER&quot;</span>)) &#123;</span><br><span class="line">        model.addAttribute(<span class="string">&quot;role&quot;</span>, <span class="string">&quot;USER&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;READ&quot;</span>)) &#123;</span><br><span class="line">        permission = permission + <span class="string">&quot; READ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (currentUser.isPermitted(<span class="string">&quot;WRITE&quot;</span>)) &#123;</span><br><span class="line">        permission = permission + <span class="string">&quot; WRITE&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    model.addAttribute(<span class="string">&quot;username&quot;</span>, currentUser.getPrincipal());</span><br><span class="line">    model.addAttribute(<span class="string">&quot;permission&quot;</span>, permission);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>On the other hand, Spring Security provides an <em>Authentication</em> object from its <em>SecurityContextHolder‘s</em> context for this purpose:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">addUserAttributes</span><span class="params">(Model model)</span> </span>&#123;</span><br><span class="line">    Authentication auth = SecurityContextHolder.getContext().getAuthentication();</span><br><span class="line">    <span class="keyword">if</span> (auth != <span class="keyword">null</span> &amp;&amp; !auth.getClass().equals(AnonymousAuthenticationToken.class)) &#123;</span><br><span class="line">        User user = (User) auth.getPrincipal();</span><br><span class="line">        model.addAttribute(<span class="string">&quot;username&quot;</span>, user.getUsername());</span><br><span class="line">        Collection&lt;GrantedAuthority&gt; authorities = user.getAuthorities();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (GrantedAuthority authority : authorities) &#123;</span><br><span class="line">            <span class="keyword">if</span> (authority.getAuthority().contains(<span class="string">&quot;USER&quot;</span>)) &#123;</span><br><span class="line">                model.addAttribute(<span class="string">&quot;role&quot;</span>, <span class="string">&quot;USER&quot;</span>);</span><br><span class="line">                model.addAttribute(<span class="string">&quot;permissions&quot;</span>, <span class="string">&quot;READ&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (authority.getAuthority().contains(<span class="string">&quot;ADMIN&quot;</span>)) &#123;</span><br><span class="line">                model.addAttribute(<span class="string">&quot;role&quot;</span>, <span class="string">&quot;ADMIN&quot;</span>);</span><br><span class="line">                model.addAttribute(<span class="string">&quot;permissions&quot;</span>, <span class="string">&quot;READ WRITE&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="5-2-POST-Login-Endpoint"><a href="#5-2-POST-Login-Endpoint" class="headerlink" title="5.2. POST Login Endpoint"></a>5.2. POST Login Endpoint</h3><p>In Shiro, we map the credentials the user enters to a POJO:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserCredentials</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// getters and setters</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then we’ll create a <em>UsernamePasswordToken</em> to log the user, or <em>Subject</em>, in:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">doLogin</span><span class="params">(HttpServletRequest req, UserCredentials credentials, RedirectAttributes attr)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    <span class="keyword">if</span> (!subject.isAuthenticated()) &#123;</span><br><span class="line">        UsernamePasswordToken token = <span class="keyword">new</span> UsernamePasswordToken(credentials.getUsername(),</span><br><span class="line">          credentials.getPassword());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subject.login(token);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (AuthenticationException ae) &#123;</span><br><span class="line">            logger.error(ae.getMessage());</span><br><span class="line">            attr.addFlashAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;Invalid Credentials&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;redirect:/login&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/home&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>On the Spring Security side, this is just a matter of redirection to the home page. Spring’s logging-in process, handled by its <em>UsernamePasswordAuthenticationFilter</em>, is transparent to us:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">doLogin</span><span class="params">(HttpServletRequest req)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/home&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-3-Admin-Only-Endpoint"><a href="#5-3-Admin-Only-Endpoint" class="headerlink" title="5.3. Admin-Only Endpoint"></a>5.3. Admin-Only Endpoint</h3><p>Now let’s look at a scenario where we have to perform role-based access. Let’s say we have an <em>/admin</em> endpoint, access to which should only be allowed for the ADMIN role.</p>
<p>Let’s see how to do this in Shiro:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/admin&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">adminOnly</span><span class="params">(ModelMap modelMap)</span> </span>&#123;</span><br><span class="line">    addUserAttributes(modelMap);</span><br><span class="line">    Subject currentUser = SecurityUtils.getSubject();</span><br><span class="line">    <span class="keyword">if</span> (currentUser.hasRole(<span class="string">&quot;ADMIN&quot;</span>)) &#123;</span><br><span class="line">        modelMap.addAttribute(<span class="string">&quot;adminContent&quot;</span>, <span class="string">&quot;only admin can view this&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Here we extracted the currently logged in user, checked if they have the ADMIN role, and added content accordingly.</p>
<p>In Spring Security, there is no need for checking the role programmatically, we’ve already defined who can reach this endpoint in our <em>SecurityConfig</em>. So now, it’s just a matter of adding business logic:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/admin&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">adminOnly</span><span class="params">(HttpServletRequest req, Model model)</span> </span>&#123;</span><br><span class="line">    addUserAttributes(model);</span><br><span class="line">    model.addAttribute(<span class="string">&quot;adminContent&quot;</span>, <span class="string">&quot;only admin can view this&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;home&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-4-Logout-Endpoint"><a href="#5-4-Logout-Endpoint" class="headerlink" title="5.4. Logout Endpoint"></a>5.4. Logout Endpoint</h3><p>Finally, let’s implement the logout endpoint.</p>
<p>In Shiro, we’ll simply call <em>Subject.logout</em>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/logout&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">logout</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    subject.logout();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;redirect:/&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For Spring, we’ve not defined any mapping for logout. In this case, its default logout mechanism kicks in, which is automatically applied since we extended <em>WebSecurityConfigurerAdapter</em> in our configuration.</p>
<h2 id="6-Apache-Shiro-vs-Spring-Security"><a href="#6-Apache-Shiro-vs-Spring-Security" class="headerlink" title="6. Apache Shiro vs Spring Security"></a>6. Apache Shiro vs Spring Security</h2><p>Now that we’ve looked at the implementation differences, let’s look at a few other aspects.</p>
<p>In terms of community support, the <strong>Spring Framework in general has a huge community of developers</strong>, actively involved in its development and usage. Since Spring Security is part of the umbrella, it must enjoy the same advantages. Shiro, though popular, does not have such humongous support.</p>
<p>Concerning documentation, Spring again is the winner.</p>
<p>However, there’s a bit of a learning curve associated with Spring Security. <strong>Shiro, on the other hand, is easy to understand</strong>. For desktop applications, configuration via <a target="_blank" rel="noopener" href="https://shiro.apache.org/configuration.html#Configuration-CreatingaSecurityManagerfromINI">shiro.ini</a> is all the easier.</p>
<p>But again, as we saw in our example snippets, <strong>Spring Security does a great job of keeping business logic and security separate</strong> and truly offers security as a cross-cutting concern.</p>
<h2 id="7-Conclusion"><a href="#7-Conclusion" class="headerlink" title="7. Conclusion"></a>7. Conclusion</h2><p>In this tutorial, <strong>we compared Apache Shiro with Spring Security</strong>.</p>
<p>We’ve just grazed the surface of what these frameworks have to offer and there is a lot to explore further. There are quite a few alternatives out there such as <a target="_blank" rel="noopener" href="https://docs.oracle.com/en/java/javase/11/security/java-authentication-and-authorization-service-jaas-reference-guide.html#GUID-2A935F5E-0803-411D-B6BC-F8C64D01A25C">JAAS</a> and <a target="_blank" rel="noopener" href="http://oaccframework.org/">OACC</a>. Still, with its advantages, <a target="_blank" rel="noopener" href="https://www.baeldung.com/security-spring">Spring Security</a> seems to be winning at this point.</p>
<p>As always, source code is available <a target="_blank" rel="noopener" href="https://github.com/eugenp/tutorials/tree/master/apache-shiro">over on GitHub</a>. </p>
<hr>
<p>[转自]<a target="_blank" rel="noopener" href="https://www.baeldung.com/spring-security-vs-apache-shiro">Spring Security vs Apache Shiro</a><br>Author: Sampada Wagde<br>Access date: Jun 23, 2021</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Security/" rel="tag"># Security</a>
              <a href="/tags/SpringBoot/" rel="tag"># SpringBoot</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/05/17/capture-packages-with-mac/" rel="prev" title="在 Mac 上监听局域网中的数据包">
                  <i class="fa fa-chevron-left"></i> 在 Mac 上监听局域网中的数据包
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jerrio</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"W0Y9YCi6j30MgJlvg32vrRv1-gzGzoHsz","app_key":"Cm6n1aD1AJ4vD2tO8zgcQJRC","server_url":"https://jerriodaddy.github.io/","security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>



</body>
</html>
